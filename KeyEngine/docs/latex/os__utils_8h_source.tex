\doxysection{os\+\_\+utils.\+h}
\hypertarget{os__utils_8h_source}{}\label{os__utils_8h_source}\index{inc/os\_utils.h@{inc/os\_utils.h}}
\mbox{\hyperlink{os__utils_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winner_8h}{winner.h}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <winternl.h>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <comdef.h>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <tlhelp32.h>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{console_8h}{console.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <ShlObj.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <wincred.h>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ POD\_ZERO(\ arg\ )\ \ \ \ \ ZeroMemory(\ \&arg,\ sizeof(\ arg\ )\ );}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceutil}{util}}}
\DoxyCodeLine{00019\ \{}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00022\ std::string\ \mbox{\hyperlink{namespaceutil_a3cb6f8f22822b4670fa970bce585e52a_a3cb6f8f22822b4670fa970bce585e52a}{printHresultErrorDescription}}(\ \textcolor{keyword}{const}\ HRESULT\ hres\ );}
\DoxyCodeLine{00023\ std::wstring\ \mbox{\hyperlink{namespaceutil_a742e4cf7eec6ab440f6a51fa98cdb42b_a742e4cf7eec6ab440f6a51fa98cdb42b}{printHresultErrorDescriptionW}}(\ \textcolor{keyword}{const}\ HRESULT\ hres\ );}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Returns\ an\ empty\ string\ if\ there\ is\ no\ error.}}
\DoxyCodeLine{00026\ std::string\ \mbox{\hyperlink{namespaceutil_a566f2bbc4b5cafc9971186f0d707bf3e_a566f2bbc4b5cafc9971186f0d707bf3e}{getLastErrorAsString}}();}
\DoxyCodeLine{00027\ std::string\ \mbox{\hyperlink{namespaceutil_a9a0b0bfad82a59556195c73d4d2cda5e_a9a0b0bfad82a59556195c73d4d2cda5e}{getLastNtErrorAsString}}(\ \textcolor{keyword}{const}\ DWORD\ ntStatusCode\ );}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ std::wstring\ \mbox{\hyperlink{namespaceutil_a35e258ec68cdc2634e69fad1574f982b_a35e258ec68cdc2634e69fad1574f982b}{bstrToStr}}(\ \textcolor{keyword}{const}\ BSTR\ \&bstr\ );}
\DoxyCodeLine{00030\ BSTR\ \mbox{\hyperlink{namespaceutil_a525e6245d3b2156e2d85aaedb8f7bb2e_a525e6245d3b2156e2d85aaedb8f7bb2e}{strToBstr}}(\ \textcolor{keyword}{const}\ std::wstring\ \&str\ );}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \_\_int64\ \mbox{\hyperlink{namespaceutil_a3e3c5eab6a6d57d880fd94d44f599cb4_a3e3c5eab6a6d57d880fd94d44f599cb4}{filetimeToInt64}}(\ \textcolor{keyword}{const}\ FILETIME\ \&fileTime\ );}
\DoxyCodeLine{00034\ [[maybe\_unused]]\ DWORD\_PTR\ \mbox{\hyperlink{namespaceutil_a12eed248853b800635a584152eda83a5_a12eed248853b800635a584152eda83a5}{pinThreadToCore}}(\ \textcolor{keyword}{const}\ HANDLE\ hThread,\ \textcolor{keyword}{const}\ DWORD\ core\ );}
\DoxyCodeLine{00035\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceutil_a26eb5943c9263e29706bf7ea9817bd26_a26eb5943c9263e29706bf7ea9817bd26}{setCurrentThreadName}}(\ \textcolor{keyword}{const}\ std::string\ \&name\ );}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ std::string\ \mbox{\hyperlink{namespaceutil_a08c4e4a29b0a0e5157b152b140bc094e_a08c4e4a29b0a0e5157b152b140bc094e}{getKnownFolderPath}}(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id}\ =\ CSIDL\_PERSONAL\ );}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#pragma\ region\ DetachedThreadsH}}
\DoxyCodeLine{00040\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceutil_a79a4c5df290b7c3f50617ad7ffa131b2_a79a4c5df290b7c3f50617ad7ffa131b2}{setupDetachedThreadsVector}}(\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ nThreads\ );}
\DoxyCodeLine{00041\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceutil_a3a780a09a3dffe65ca6df0ff68298fa9_a3a780a09a3dffe65ca6df0ff68298fa9}{terminateDetachedThreads}}();}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#pragma\ endregion\ DetachedThreadsH}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ std::optional<DWORD>\ \mbox{\hyperlink{namespaceutil_a2e444da6f9f3edb24cbdfdd3acd8eef5_a2e444da6f9f3edb24cbdfdd3acd8eef5}{registryGetDword}}(\ \textcolor{keyword}{const}\ HKEY\ hKey,\ \textcolor{keyword}{const}\ std::wstring\ \&regName\ );}
\DoxyCodeLine{00045\ std::optional<std::wstring>\ \mbox{\hyperlink{namespaceutil_a461bbc2dfa40d2dae1639cce3f6db772_a461bbc2dfa40d2dae1639cce3f6db772}{registryGetString}}(\ \textcolor{keyword}{const}\ HKEY\ hKey,\ \textcolor{keyword}{const}\ std::wstring\ \&regName\ );}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceutil_a833373d99efbf126ccbb44456500085f_a833373d99efbf126ccbb44456500085f}{suspendAllThreads}}();}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespaceutil_a49087246809a040488fc33d84239de83_a49087246809a040488fc33d84239de83}{launchProcess}}(\ \textcolor{keyword}{const}\ std::string\ \&path\ );}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ TCallback,\ \textcolor{keyword}{typename}...\ TArgs>}
\DoxyCodeLine{00052\ \textcolor{keyword}{decltype}(\ auto\ )\ \mbox{\hyperlink{namespaceutil_ad7c794e52973c3fe00e125e69d29a011_ad7c794e52973c3fe00e125e69d29a011}{askForCredentials}}(\ TCallback\ \&\&f,}
\DoxyCodeLine{00053\ \ \ \ \ TArgs\ \&\&...\ args\ )}
\DoxyCodeLine{00054\ \{}
\DoxyCodeLine{00055\ \ \ \ \ CREDUI\_INFO\ cui;}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ pszName[CREDUI\_MAX\_USERNAME\_LENGTH\ +\ 1];}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ pszPwd[CREDUI\_MAX\_PASSWORD\_LENGTH\ +\ 1];}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ cui.cbSize\ =\ \textcolor{keyword}{sizeof}(\ CREDUI\_INFO\ );}
\DoxyCodeLine{00060\ \ \ \ \ cui.hwndParent\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ ensure\ that\ MessageText\ and\ CaptionText\ identify\ what\ credentials\ to\ use\ and\ which\ application\ requires\ them}}
\DoxyCodeLine{00062\ \ \ \ \ cui.pszMessageText\ =\ L\textcolor{stringliteral}{"{}Enter\ administrator\ account\ information"{}};}
\DoxyCodeLine{00063\ \ \ \ \ cui.pszCaptionText\ =\ L\textcolor{stringliteral}{"{}CredUITest"{}};}
\DoxyCodeLine{00064\ \ \ \ \ cui.hbmBanner\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00065\ \ \ \ \ BOOL\ fSave\ =\ FALSE;}
\DoxyCodeLine{00066\ \ \ \ \ SecureZeroMemory(\ pszName,\ \textcolor{keyword}{sizeof}(\ pszName\ )\ );}
\DoxyCodeLine{00067\ \ \ \ \ SecureZeroMemory(\ pszPwd,\ \textcolor{keyword}{sizeof}(\ pszPwd\ )\ );}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ dwErr\ =\ CredUIPromptForCredentialsW(\ \&cui,\ \textcolor{comment}{//\ CREDUI\_INFO\ structure}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ TEXT(\textcolor{stringliteral}{"{}TheServer"{}}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ target\ for\ credentials\ (usually\ a\ server)}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ reserved}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ 0,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ reason}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ pszName,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ user\ name}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ CREDUI\_MAX\_USERNAME\_LENGTH\ +\ 1,\ \textcolor{comment}{//\ max\ number\ of\ chars\ for\ user\ name}}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ pszPwd,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ password}}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ CREDUI\_MAX\_PASSWORD\_LENGTH\ +\ 1,\ \textcolor{comment}{//\ max\ number\ of\ chars\ for\ password}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \&fSave,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ state\ of\ save\ check\ box}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ CREDUI\_FLAGS\_GENERIC\_CREDENTIALS\ |\ CREDUI\_FLAGS\_ALWAYS\_SHOW\_UI\ |\ CREDUI\_FLAGS\_DO\_NOT\_PERSIST\ );}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{auto}\ ret;}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !dwErr\ )}
\DoxyCodeLine{00081\ \ \ \ \ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ Put\ code\ that\ uses\ the\ credentials\ here.}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ ret\ =\ std::invoke(\ std::forward<TCallback>(\ f\ ),\ std::forward<TArgs>(\ args\ )\ ...\ );}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ when\ you\ have\ finished\ using\ the\ credentials,\ erase\ them\ from\ memory.}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ SecureZeroMemory(\ pszName,\ \textcolor{keyword}{sizeof}(\ pszName\ )\ );}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ SecureZeroMemory(\ pszPwd,\ \textcolor{keyword}{sizeof}(\ pszPwd\ )\ );}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00090\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \}\textcolor{comment}{//\ namespace\ util}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#if\ defined\ \_DEBUG\ \&\&\ !defined\ NDEBUG}}
\DoxyCodeLine{00097\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_RETURN\_HRES\_IF\_FAILED(\ hres\ )\ if\ (\ FAILED(\ hres\ )\ )\(\backslash\)}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\ \ \ \ \{\(\backslash\)}}
\DoxyCodeLine{00099\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::ostringstream\ oss;\(\backslash\)}}
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ namespace\ std::string\_literals;\(\backslash\)}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ oss\ <<\ "{}\(\backslash\)n"{}s\ <<\ \_\_FUNCTION\_\_\ <<\ "{}\ @\ line:\ "{}s\ <<\ \_\_LINE\_\_\ <<\ "{}\(\backslash\)n"{}s\ <<\ util::printHresultErrorDescription(\ hres\ )\ <<\ "{}\(\backslash\)n\(\backslash\)n"{}s;\(\backslash\)}}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ KeyConsole\ \&console\ =\ KeyConsole::getInstance();\(\backslash\)}}
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ console.log(\ oss.str()\ );\(\backslash\)}}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \_\_debugbreak();\(\backslash\)}}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ hres;\(\backslash\)}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_RETURN\_HRES\_IF\_FAILED(\ hres\ )\ (void)0;}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#if\ defined\ \_DEBUG\ \&\&\ !defined\ NDEBUG}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_IF\_FAILED(\ hres\ )\ if\ (\ FAILED(\ hres\ )\ )\(\backslash\)}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\ \ \ \ \{\(\backslash\)}}
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::ostringstream\ oss;\(\backslash\)}}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ namespace\ std::string\_literals;\(\backslash\)}}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ oss\ <<\ "{}\(\backslash\)n"{}s\ <<\ \_\_FUNCTION\_\_\ <<\ "{}\ @\ line:\ "{}s\ <<\ \_\_LINE\_\_\ <<\ "{}\(\backslash\)n"{}s\ <<\ util::printHresultErrorDescription(\ hres\ )\ <<\ "{}\(\backslash\)n\(\backslash\)n"{}s;\(\backslash\)}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ KeyConsole\ \&console\ =\ KeyConsole::getInstance();\(\backslash\)}}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ console.log(\ oss.str()\ );\(\backslash\)}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \_\_debugbreak();\(\backslash\)}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::exit(\ hres\ );\(\backslash\)}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_IF\_FAILED(\ hres\ )\ (void)0;}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\#if\ defined\ \_DEBUG\ \&\&\ !defined\ NDEBUG}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_IF\_FAILED\ if\ (\ FAILED(\ hres\ )\ )\(\backslash\)}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\ \ \ \ \{\(\backslash\)}}
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::ostringstream\ oss;\(\backslash\)}}
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ namespace\ std::string\_literals;\(\backslash\)}}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ oss\ <<\ "{}\(\backslash\)n"{}s\ <<\ \_\_FUNCTION\_\_\ <<\ "{}\ @\ line:\ "{}s\ <<\ \_\_LINE\_\_\ <<\ "{}\(\backslash\)n"{}s\ <<\ util::printHresultErrorDescription(\ hres\ )\ <<\ "{}\(\backslash\)n\(\backslash\)n"{}s;\(\backslash\)}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ KeyConsole\ \&console\ =\ KeyConsole::getInstance();\(\backslash\)}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ console.log(\ oss.str()\ );\(\backslash\)}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \_\_debugbreak();\(\backslash\)}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::exit(\ hres\ );\(\backslash\)}}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_IF\_FAILED\ (void)0;}}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\#if\ defined\ \_DEBUG\ \&\&\ !defined\ NDEBUG}}
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_IF\_FAILED\_MSG(\ msg\ )\ if\ (\ FAILED(\ hres\ )\ )\(\backslash\)}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\ \ \ \ \{\(\backslash\)}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::ostringstream\ oss;\(\backslash\)}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ namespace\ std::string\_literals;\(\backslash\)}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ oss\ <<\ "{}\(\backslash\)n"{}s\ <<\ \_\_FUNCTION\_\_\ <<\ "{}\ @\ line:\ "{}s\ <<\ \_\_LINE\_\_\ <<\ "{}\(\backslash\)n"{}s\ <<\ util::printHresultErrorDescription(\ hres\ )\ <<\ "{}\(\backslash\)n"{}\ <<\ "{}msg:\ "{}\ <<\ msg\ <<\ "{}\(\backslash\)n\(\backslash\)n"{}s;\(\backslash\)}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ KeyConsole\ \&console\ =\ KeyConsole::getInstance();\(\backslash\)}}
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ console.log(\ oss.str()\ );\(\backslash\)}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \_\_debugbreak();\(\backslash\)}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::exit(\ hres\ );\(\backslash\)}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_IF\_FAILED\_MSG\ (void)0;}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#if\ defined\ \_DEBUG\ \&\&\ !defined\ NDEBUG}}
\DoxyCodeLine{00158\ \textcolor{comment}{//\ or\ call\ getLastErrorAsString()}}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_WIN32\_IF\_FAILED\ \(\backslash\)}}
\DoxyCodeLine{00160\ \textcolor{preprocessor}{\ \ \ \ \{\ \(\backslash\)}}
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ HRESULT\ hres\ =\ HRESULT\_FROM\_WIN32(\ GetLastError()\ );\ \(\backslash\)}}
\DoxyCodeLine{00162\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ ASSERT\_HRES\_IF\_FAILED;\ \(\backslash\)}}
\DoxyCodeLine{00163\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_WIN32\_IF\_FAILED\ (void)0;}}
\DoxyCodeLine{00166\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \textcolor{preprocessor}{\#if\ defined\ \_DEBUG\ \&\&\ !defined\ NDEBUG}}
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_NTSTATUS\_IF\_FAILED(\ ntErrorCode\ )\ \(\backslash\)}}
\DoxyCodeLine{00170\ \textcolor{preprocessor}{\ \ \ \ \{\(\backslash\)}}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::ostringstream\ oss;\(\backslash\)}}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ using\ namespace\ std::string\_literals;\(\backslash\)}}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ oss\ <<\ "{}\(\backslash\)n"{}s\ <<\ \_\_FUNCTION\_\_\ <<\ "{}\ @\ line:\ "{}s\ <<\ \_\_LINE\_\_\ <<\ "{}\(\backslash\)n"{}s\ <<\ util::getLastNtErrorAsString(\ ntErrorCode\ )\ <<\ "{}\(\backslash\)n\(\backslash\)n"{}s;\(\backslash\)}}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ KeyConsole\ \&console\ =\ KeyConsole::getInstance();\(\backslash\)}}
\DoxyCodeLine{00175\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ console.log(\ oss.str()\ );\(\backslash\)}}
\DoxyCodeLine{00176\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \_\_debugbreak();\(\backslash\)}}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::exit(\ hres\ );\(\backslash\)}}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00179\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00180\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_NTSTATUS\_IF\_FAILED\ (void)0;}}
\DoxyCodeLine{00181\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\#if\ defined\ \_DEBUG\ \&\&\ !defined\ NDEBUG}}
\DoxyCodeLine{00185\ \textcolor{comment}{//\ or\ call\ getLastErrorAsString()}}
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_REGISTRY\_IF\_FAILED(\ ret\ )\ \(\backslash\)}}
\DoxyCodeLine{00187\ \textcolor{preprocessor}{\ \ \ \ if\ (\ ret\ !=\ ERROR\_SUCCESS\ )\(\backslash\)}}
\DoxyCodeLine{00188\ \textcolor{preprocessor}{\ \ \ \ \{\(\backslash\)}}
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ wchar\_t\ buffer[MAX\_PATH];\(\backslash\)}}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ FormatMessageW(\ FORMAT\_MESSAGE\_FROM\_SYSTEM,\ nullptr,\ ret,\ 0,\ buffer,\ MAX\_PATH,\ nullptr\ );\(\backslash\)}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ KeyConsole\ \&console\ =\ KeyConsole::getInstance();\(\backslash\)}}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ console.print(\ util::ws2s(\ buffer\ )\ );\(\backslash\)}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \_\_debugbreak();\(\backslash\)}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ std::exit(\ ret\ );\(\backslash\)}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\ \ \ \ \}}}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\#\ \ \ define\ ASSERT\_HRES\_REGISTRY\_IF\_FAILED\ (void)0;}}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
